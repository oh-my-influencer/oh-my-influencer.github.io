<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>âœ¨ Influencer Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet" />
  <style>
    /* â”€â”€ ë³€ìˆ˜ â”€â”€ */
    :root {
      --pink-50:  #fff0f5;
      --pink-100: #ffe0ec;
      --pink-200: #ffb3cf;
      --pink-400: #ff6fa3;
      --pink-500: #ff4d8d;
      --pink-600: #e63d7a;
      --rose-100: #ffe4e9;
      --peach:    #ffede0;
      --white:    #ffffff;
      --gray-400: #b0b7c3;
      --gray-600: #6b7280;
      --gray-800: #1f2937;
      --radius-card: 20px;
      --radius-pill: 999px;
      --shadow-card: 0 4px 24px rgba(255, 100, 160, 0.10);
      --shadow-hover: 0 12px 40px rgba(255, 100, 160, 0.22);
    }

    /* â”€â”€ ë¦¬ì…‹ & ê¸°ë³¸ â”€â”€ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Nunito', 'Noto Sans KR', sans-serif;
      background: var(--pink-50);
      color: var(--gray-800);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* â”€â”€ ë°°ê²½ ë©”ì‰¬ â”€â”€ */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 60% 50% at 10% 0%, #ffd6e7 0%, transparent 60%),
        radial-gradient(ellipse 50% 40% at 90% 100%, #ffc8d8 0%, transparent 55%),
        radial-gradient(ellipse 40% 40% at 50% 50%, #fff0f8 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    /* â”€â”€ ë ˆì´ì•„ì›ƒ ë˜í¼ â”€â”€ */
    .wrapper {
      position: relative;
      z-index: 1;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 24px 60px;
    }

    /* â”€â”€ í—¤ë” â”€â”€ */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 36px 0 28px;
      gap: 16px;
      flex-wrap: wrap;
    }
    .header-title {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .header-title .logo {
      width: 44px; height: 44px;
      background: linear-gradient(135deg, var(--pink-400), var(--pink-600));
      border-radius: 14px;
      display: flex; align-items: center; justify-content: center;
      font-size: 22px;
      box-shadow: 0 4px 14px rgba(255,77,141,0.35);
    }
    .header-title h1 {
      font-size: 1.6rem;
      font-weight: 900;
      background: linear-gradient(135deg, var(--pink-500), #c94080);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -0.5px;
    }
    .header-meta {
      font-size: 0.78rem;
      color: var(--gray-400);
      font-weight: 600;
    }
    #last-updated {
      font-weight: 700;
      color: var(--pink-500);
    }

    /* â”€â”€ í†µê³„ ë°°ë„ˆ â”€â”€ */
    .stats-bar {
      display: flex;
      gap: 14px;
      margin-bottom: 28px;
      flex-wrap: wrap;
    }
    .stat-chip {
      background: var(--white);
      border-radius: var(--radius-pill);
      padding: 10px 20px;
      font-size: 0.82rem;
      font-weight: 700;
      color: var(--gray-600);
      box-shadow: var(--shadow-card);
      display: flex;
      align-items: center;
      gap: 8px;
      animation: fadeUp 0.5s ease both;
    }
    .stat-chip span.num {
      font-size: 1rem;
      font-weight: 900;
      color: var(--pink-500);
    }

    /* â”€â”€ í•„í„° ì˜ì—­ â”€â”€ */
    .filter-bar {
      background: var(--white);
      border-radius: var(--radius-card);
      padding: 20px 24px;
      margin-bottom: 28px;
      box-shadow: var(--shadow-card);
      display: flex;
      align-items: center;
      gap: 16px;
      flex-wrap: wrap;
    }
    .filter-bar label {
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--gray-600);
      white-space: nowrap;
    }

    /* íƒ­ */
    .tab-group {
      display: flex;
      gap: 6px;
    }
    .tab-btn {
      padding: 7px 16px;
      border-radius: var(--radius-pill);
      border: 2px solid var(--pink-200);
      background: transparent;
      color: var(--gray-600);
      font-family: inherit;
      font-size: 0.82rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.18s;
    }
    .tab-btn:hover { border-color: var(--pink-400); color: var(--pink-500); }
    .tab-btn.active {
      background: linear-gradient(135deg, var(--pink-400), var(--pink-600));
      border-color: transparent;
      color: #fff;
      box-shadow: 0 4px 12px rgba(255,77,141,0.30);
    }

    /* Tier í•„í„° */
    .tier-select, .sort-select {
      padding: 8px 14px;
      border-radius: var(--radius-pill);
      border: 2px solid var(--pink-200);
      background: var(--white);
      color: var(--gray-800);
      font-family: inherit;
      font-size: 0.82rem;
      font-weight: 700;
      cursor: pointer;
      outline: none;
      transition: border-color 0.18s;
      appearance: none;
      -webkit-appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%23ff6fa3' stroke-width='2' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 32px;
    }
    .tier-select:focus, .sort-select:focus { border-color: var(--pink-400); }

    /* ê²€ìƒ‰ */
    .search-wrap {
      flex: 1;
      min-width: 180px;
      position: relative;
    }
    .search-wrap input {
      width: 100%;
      padding: 9px 16px 9px 38px;
      border-radius: var(--radius-pill);
      border: 2px solid var(--pink-200);
      background: var(--white);
      font-family: inherit;
      font-size: 0.84rem;
      font-weight: 600;
      color: var(--gray-800);
      outline: none;
      transition: border-color 0.18s;
    }
    .search-wrap input:focus { border-color: var(--pink-400); }
    .search-wrap input::placeholder { color: var(--gray-400); }
    .search-wrap .search-icon {
      position: absolute;
      left: 13px; top: 50%;
      transform: translateY(-50%);
      font-size: 15px;
      pointer-events: none;
    }

    /* â”€â”€ ê²°ê³¼ ìˆ˜ â”€â”€ */
    .result-count {
      font-size: 0.82rem;
      font-weight: 700;
      color: var(--gray-400);
      margin-bottom: 18px;
    }
    .result-count strong { color: var(--pink-500); }

    /* â”€â”€ ì¹´ë“œ ê·¸ë¦¬ë“œ â”€â”€ */
    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 20px;
    }

    /* â”€â”€ ì¸í”Œë£¨ì–¸ì„œ ì¹´ë“œ â”€â”€ */
    .card {
      background: var(--white);
      border-radius: var(--radius-card);
      padding: 24px 20px 20px;
      box-shadow: var(--shadow-card);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      text-align: center;
      transition: transform 0.22s, box-shadow 0.22s;
      animation: fadeUp 0.4s ease both;
      cursor: pointer;
      text-decoration: none;
      color: inherit;
    }
    .card:hover {
      transform: translateY(-6px);
      box-shadow: var(--shadow-hover);
    }

    .card-avatar {
      width: 72px; height: 72px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--pink-200);
      background: var(--pink-100);
    }
    .card-avatar-placeholder {
      width: 72px; height: 72px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--pink-200), var(--pink-400));
      display: flex; align-items: center; justify-content: center;
      font-size: 28px;
      border: 3px solid var(--pink-200);
    }

    .card-name {
      font-size: 0.95rem;
      font-weight: 800;
      color: var(--gray-800);
      line-height: 1.2;
    }
    .card-handle {
      font-size: 0.78rem;
      color: var(--gray-400);
      font-weight: 600;
    }

    /* Tier ë±ƒì§€ */
    .tier-badge {
      padding: 3px 12px;
      border-radius: var(--radius-pill);
      font-size: 0.7rem;
      font-weight: 800;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }
    .tier-mega   { background: #fff0c2; color: #b07800; }
    .tier-macro  { background: #ffe0ec; color: #c0004a; }
    .tier-mid    { background: #e8f0ff; color: #2244cc; }
    .tier-micro  { background: #e6faf0; color: #007a40; }
    .tier-nano   { background: #f3f0ff; color: #5500cc; }

    /* í”Œë«í¼ ë±ƒì§€ */
    .platform-badge {
      font-size: 0.72rem;
      font-weight: 700;
      padding: 3px 10px;
      border-radius: var(--radius-pill);
      background: var(--pink-50);
      color: var(--pink-600);
      border: 1.5px solid var(--pink-200);
    }

    /* ìŠ¤íƒ¯ í–‰ */
    .card-stats {
      width: 100%;
      display: flex;
      justify-content: space-around;
      padding: 12px 0 0;
      border-top: 1.5px dashed var(--pink-100);
      gap: 8px;
    }
    .card-stat {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
    }
    .card-stat .val {
      font-size: 0.95rem;
      font-weight: 900;
      color: var(--gray-800);
    }
    .card-stat .lbl {
      font-size: 0.68rem;
      font-weight: 700;
      color: var(--gray-400);
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    /* â”€â”€ ë¡œë”© / ì—ëŸ¬ / ë¹ˆ ìƒíƒœ â”€â”€ */
    .state-box {
      grid-column: 1 / -1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 14px;
      padding: 60px 0;
      color: var(--gray-400);
      font-weight: 700;
      font-size: 0.95rem;
    }
    .state-box .icon { font-size: 3rem; }

    .spinner {
      width: 40px; height: 40px;
      border: 4px solid var(--pink-100);
      border-top-color: var(--pink-400);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    /* â”€â”€ ì• ë‹ˆë©”ì´ì…˜ â”€â”€ */
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(18px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* â”€â”€ ë°˜ì‘í˜• â”€â”€ */
    @media (max-width: 600px) {
      header { padding: 24px 0 20px; }
      .filter-bar { flex-direction: column; align-items: stretch; }
      .tab-group { flex-wrap: wrap; }
    }
  </style>
</head>
<body>
<div class="wrapper">

  <!-- í—¤ë” -->
  <header>
    <div class="header-title">
      <div class="logo">ğŸŒ¸</div>
      <h1>Influencer Dashboard</h1>
    </div>
    <div class="header-meta">
      ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: <span id="last-updated">â€”</span>
    </div>
  </header>

  <!-- í†µê³„ ë°°ë„ˆ -->
  <div class="stats-bar" id="stats-bar">
    <div class="stat-chip"><span class="num" id="stat-total">â€”</span> ì´ ì¸í”Œë£¨ì–¸ì„œ</div>
    <div class="stat-chip"><span class="num" id="stat-mega">â€”</span> Mega</div>
    <div class="stat-chip"><span class="num" id="stat-macro">â€”</span> Macro</div>
    <div class="stat-chip"><span class="num" id="stat-mid">â€”</span> Mid</div>
    <div class="stat-chip"><span class="num" id="stat-micro">â€”</span> Micro</div>
  </div>

  <!-- í•„í„° ë°” -->
  <div class="filter-bar">
    <!-- í”Œë«í¼ íƒ­ -->
    <label>í”Œë«í¼</label>
    <div class="tab-group" id="platform-tabs">
      <button class="tab-btn active" data-platform="all">ì „ì²´</button>
      <button class="tab-btn" data-platform="youtube">ğŸ¬ YouTube</button>
      <button class="tab-btn" data-platform="instagram">ğŸ“¸ Instagram</button>
      <button class="tab-btn" data-platform="tiktok">ğŸµ TikTok</button>
    </div>

    <!-- Tier í•„í„° -->
    <label>Tier</label>
    <select class="tier-select" id="tier-filter">
      <option value="all">ì „ì²´ Tier</option>
      <option value="mega">ğŸŒŸ Mega (100ë§Œ+)</option>
      <option value="macro">ğŸ’« Macro (10ë§Œ+)</option>
      <option value="mid">âœ¨ Mid (5ë§Œ+)</option>
      <option value="micro">â­ Micro (1ë§Œ+)</option>
      <option value="nano">ğŸŒ± Nano (~1ë§Œ)</option>
    </select>

    <!-- ì •ë ¬ -->
    <label>ì •ë ¬</label>
    <select class="sort-select" id="sort-filter">
      <option value="followers_desc">êµ¬ë…ì ë§ì€ ìˆœ</option>
      <option value="followers_asc">êµ¬ë…ì ì ì€ ìˆœ</option>
      <option value="name_asc">ì´ë¦„ ìˆœ</option>
    </select>

    <!-- ê²€ìƒ‰ -->
    <div class="search-wrap">
      <span class="search-icon">ğŸ”</span>
      <input type="text" id="search-input" placeholder="ì´ë¦„ ë˜ëŠ” í•¸ë“¤ ê²€ìƒ‰..." />
    </div>
  </div>

  <!-- ê²°ê³¼ ìˆ˜ -->
  <p class="result-count" id="result-count"></p>

  <!-- ì¹´ë“œ ê·¸ë¦¬ë“œ -->
  <div class="card-grid" id="card-grid">
    <div class="state-box">
      <div class="spinner"></div>
      <span>ë°ì´í„° ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
    </div>
  </div>

</div>

<script>
// â”€â”€ ìˆ«ì í¬ë§· â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function fmt(n) {
  if (n == null) return 'â€”';
  if (n >= 1_000_000) return (n / 1_000_000).toFixed(1) + 'M';
  if (n >= 1_000)     return (n / 1_000).toFixed(1) + 'K';
  return n.toLocaleString();
}

// â”€â”€ í‹°ì–´ ë±ƒì§€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const TIER_LABEL = { mega: 'ğŸŒŸ Mega', macro: 'ğŸ’« Macro', mid: 'âœ¨ Mid', micro: 'â­ Micro', nano: 'ğŸŒ± Nano' };
function tierBadge(tier) {
  return `<span class="tier-badge tier-${tier}">${TIER_LABEL[tier] ?? tier}</span>`;
}

// â”€â”€ í”Œë«í¼ ë±ƒì§€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PLATFORM_LABEL = { youtube: 'ğŸ¬ YouTube', instagram: 'ğŸ“¸ Instagram', tiktok: 'ğŸµ TikTok' };
function platformBadge(p) {
  return `<span class="platform-badge">${PLATFORM_LABEL[p] ?? p}</span>`;
}

// â”€â”€ ì¹´ë“œ ë Œë” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderCard(inf) {
  const avatar = inf.profile_image
    ? `<img class="card-avatar" src="${inf.profile_image}" alt="${inf.name}" loading="lazy" onerror="this.replaceWith(makePlaceholder())">`
    : `<div class="card-avatar-placeholder">ğŸŒ¸</div>`;

  const subLabel = inf.platform === 'youtube' ? 'êµ¬ë…ì' : 'íŒ”ë¡œì›Œ';

  const extraStat = inf.platform === 'youtube'
    ? `<div class="card-stat"><span class="val">${fmt(inf.avg_views_per_video)}</span><span class="lbl">í‰ê· ì¡°íšŒ</span></div>`
    : inf.engagement_rate != null
      ? `<div class="card-stat"><span class="val">${inf.engagement_rate}%</span><span class="lbl">ì°¸ì—¬ìœ¨</span></div>`
      : '';

  return `
    <a class="card" href="${inf.profile_url}" target="_blank" rel="noopener">
      ${avatar}
      <div class="card-name">${inf.name}</div>
      <div class="card-handle">@${inf.handle}</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;justify-content:center">
        ${platformBadge(inf.platform)}
        ${tierBadge(inf.tier)}
      </div>
      <div class="card-stats">
        <div class="card-stat">
          <span class="val">${fmt(inf.followers)}</span>
          <span class="lbl">${subLabel}</span>
        </div>
        ${extraStat}
        <div class="card-stat">
          <span class="val">${inf.video_count != null ? fmt(inf.video_count) : 'â€”'}</span>
          <span class="lbl">ì˜ìƒ ìˆ˜</span>
        </div>
      </div>
    </a>`;
}

function makePlaceholder() {
  const d = document.createElement('div');
  d.className = 'card-avatar-placeholder';
  d.textContent = 'ğŸŒ¸';
  return d;
}

// â”€â”€ ìƒíƒœ(ë¡œë”©/ì—ëŸ¬/ë¹ˆ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showState(icon, msg) {
  document.getElementById('card-grid').innerHTML =
    `<div class="state-box"><div class="icon">${icon}</div><span>${msg}</span></div>`;
}

// â”€â”€ ë©”ì¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let allData = [];

// í•„í„° ìƒíƒœ
let filters = { platform: 'all', tier: 'all', sort: 'followers_desc', query: '' };

function applyFilters() {
  let list = [...allData];

  if (filters.platform !== 'all')
    list = list.filter(i => i.platform === filters.platform);
  if (filters.tier !== 'all')
    list = list.filter(i => i.tier === filters.tier);
  if (filters.query)
    list = list.filter(i =>
      i.name.toLowerCase().includes(filters.query) ||
      i.handle.toLowerCase().includes(filters.query));

  // ì •ë ¬
  if (filters.sort === 'followers_desc') list.sort((a,b) => b.followers - a.followers);
  if (filters.sort === 'followers_asc')  list.sort((a,b) => a.followers - b.followers);
  if (filters.sort === 'name_asc')       list.sort((a,b) => a.name.localeCompare(b.name));

  render(list);
}

function render(list) {
  const grid = document.getElementById('card-grid');
  document.getElementById('result-count').innerHTML =
    `ì´ <strong>${list.length}</strong>ëª…ì˜ ì¸í”Œë£¨ì–¸ì„œ`;

  if (list.length === 0) {
    showState('ğŸ”', 'ì¡°ê±´ì— ë§ëŠ” ì¸í”Œë£¨ì–¸ì„œê°€ ì—†ì–´ìš”');
    return;
  }

  grid.innerHTML = list.map((inf, i) => {
    const card = renderCard(inf);
    // ìˆœì°¨ í˜ì´ë“œì¸ ë”œë ˆì´
    return card.replace('class="card"', `class="card" style="animation-delay:${Math.min(i * 0.04, 0.6)}s"`);
  }).join('');
}

function updateStats(data) {
  const count = t => data.filter(i => i.tier === t).length;
  document.getElementById('stat-total').textContent  = data.length;
  document.getElementById('stat-mega').textContent   = count('mega');
  document.getElementById('stat-macro').textContent  = count('macro');
  document.getElementById('stat-mid').textContent    = count('mid');
  document.getElementById('stat-micro').textContent  = count('micro');
}

async function init() {
  try {
    const res = await fetch('data/influencers.json');
    if (!res.ok) throw new Error(res.status);
    const json = await res.json();

    allData = json.influencers ?? [];

    // ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸
    if (json.generated_at) {
      const d = new Date(json.generated_at);
      document.getElementById('last-updated').textContent =
        d.toLocaleDateString('ko-KR', { year:'numeric', month:'long', day:'numeric' });
    }

    updateStats(allData);
    applyFilters();
  } catch (e) {
    showState('ğŸŒ¸', 'influencers.jsonì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ì–´ìš”. GitHub Actionsê°€ ì•„ì§ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆì–´ìš”.');
    console.error(e);
  }
}

// â”€â”€ ì´ë²¤íŠ¸ ë°”ì¸ë”© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('platform-tabs').addEventListener('click', e => {
  const btn = e.target.closest('.tab-btn');
  if (!btn) return;
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  filters.platform = btn.dataset.platform;
  applyFilters();
});

document.getElementById('tier-filter').addEventListener('change', e => {
  filters.tier = e.target.value;
  applyFilters();
});

document.getElementById('sort-filter').addEventListener('change', e => {
  filters.sort = e.target.value;
  applyFilters();
});

let searchTimer;
document.getElementById('search-input').addEventListener('input', e => {
  clearTimeout(searchTimer);
  searchTimer = setTimeout(() => {
    filters.query = e.target.value.trim().toLowerCase();
    applyFilters();
  }, 250);
});

init();
</script>
</body>
</html>